# RouteGuard

**–í–∞—à —Å–≤–æ–±–æ–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç** ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è VPN-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è OPKG Entware (Keenetic —Ä–æ—É—Ç–µ—Ä—ã)

![Version](https://img.shields.io/badge/version-0.1.0-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Platform](https://img.shields.io/badge/platform-Entware-orange.svg)

---

## üìñ –û –ø—Ä–æ–µ–∫—Ç–µ

RouteGuard ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è VPN-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–æ—É—Ç–µ—Ä–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:

- **WireGuard, AmneziaWG, VLESS, Hysteria2, Shadowsocks, Trojan**
- **–£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** (–¥–æ–º–µ–Ω—ã, GeoIP, CIDR)
- **DNS —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ä–µ–∫–ª–∞–º—ã** (DoH/DoT, DNS rewrite)
- **–û–±—Ö–æ–¥ DPI** –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ VPN

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

| ‚ú® | |
|---|---|
| üöÄ | –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π `curl \| sh` |
| üé® | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Web UI (Light/Pro —Ä–µ–∂–∏–º—ã) |
| üõ°Ô∏è | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, GPG-–ø–æ–¥–ø–∏—Å–∏, rate limiting |
| ‚ö° | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è embedded: <30MB RAM, <10% CPU |
| üß© | –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî –≤–∫–ª—é—á–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ |
| üîÑ | –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ |

---

## üì¶ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### –®–∞–≥ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤

```bash
opkg update
```

#### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ curl (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
opkg install curl
```

–ò–ª–∏ —á–µ—Ä–µ–∑ wget:
```bash
opkg install wget
```

#### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ RouteGuard

```bash
curl -sL https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/install.sh | sh
```

–ò–ª–∏ —á–µ—Ä–µ–∑ wget:
```bash
wget -qO- https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/install.sh | sh
```

### –ß–µ—Ä–µ–∑ OPKG

```bash
opkg update
opkg install https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/routeguard.ipk
```

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   RouteGuard —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!   ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

  Web UI:  http://192.168.1.1:8080
  –¢–æ–∫–µ–Ω:   your-api-token-here

  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
    /opt/etc/init.d/S50rguard start|stop|restart|status
```

---

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. VPN –ú–µ–Ω–µ–¥–∂–µ—Ä

- ‚úÖ –ò–º–ø–æ—Ä—Ç –∏–∑ –ø–æ–¥–ø–∏—Å–æ–∫ (URL)
- ‚úÖ –ò–º–ø–æ—Ä—Ç –∏–∑ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥–æ–≤
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã:**
- WireGuard / AmneziaWG
- VLESS (Reality, Vision)
- Hysteria2
- Shadowsocks
- Trojan

### 2. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

- ‚úÖ –î–æ–º–µ–Ω–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (`.ru` ‚Üí direct, `.com` ‚Üí VPN)
- ‚úÖ GeoIP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (–ø–æ —Å—Ç—Ä–∞–Ω–∞–º)
- ‚úÖ CIDR –ø—Ä–∞–≤–∏–ª–∞
- ‚úÖ Failover (—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ)
- ‚úÖ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

### 3. DNS –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã

- ‚úÖ DNS —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ
- ‚úÖ DNS over HTTPS / TLS
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ DNS upstream
- ‚úÖ DNS rewrite
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫–ª–∞–º—ã (—Å–ø–∏—Å–∫–∏)
- ‚úÖ Per-device –ø–æ–ª–∏—Ç–∏–∫–∏

### 4. –û–±—Ö–æ–¥ DPI

- ‚úÖ –°–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π –æ–±—Ö–æ–¥ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤
- ‚úÖ –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤
- ‚úÖ TLS –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏
- ‚úÖ –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Web UI (Vue 3)                       ‚îÇ
‚îÇ              (Light Mode / Pro Mode)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
                          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 Backend (Go + Gin)                      ‚îÇ
‚îÇ                    REST API                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                   ‚îÇ                   ‚îÇ
        ‚ñº                   ‚ñº                   ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  VPN Module   ‚îÇ ‚îÇ Routing Module  ‚îÇ ‚îÇ  DNS Module     ‚îÇ
‚îÇ  (sing-box)   ‚îÇ ‚îÇ  (Xray-core)    ‚îÇ ‚îÇ  (smartdns)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ
        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  DPI Module   ‚îÇ
‚îÇ  (ByeDPI)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| Backend | Go 1.21 + Gin |
| Frontend | Vue 3 + Vite + Naive UI |
| VPN Core | sing-box |
| Routing | Xray-core |
| DNS | smartdns / AdGuard Home |
| DPI Bypass | ByeDPI / Zapret |

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞](docs/installation.md)
- [‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](docs/configuration.md)
- [üîå VPN –º–æ–¥—É–ª—å](docs/modules/vpn.md)
- [üõ£Ô∏è –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è](docs/modules/routing.md)
- [üåê DNS –º–æ–¥—É–ª—å](docs/modules/dns.md)
- [üö´ DPI –æ–±—Ö–æ–¥](docs/modules/dpi.md)
- [üñ•Ô∏è API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/api.md)
- [üíª CLI –∫–æ–º–∞–Ω–¥—ã](docs/cli.md)

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### CLI

```bash
# –°—Ç–∞—Ç—É—Å
routeguard status

# –ó–∞–ø—É—Å–∫ / –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
routeguard start
routeguard stop
routeguard restart

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
routeguard update

# –ë—ç–∫–∞–ø / –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
routeguard backup > backup.json
routeguard restore < backup.json

# –î–µ–±–∞–≥
routeguard logs --follow
```

### –°–µ—Ä–≤–∏—Å

```bash
/opt/etc/init.d/S50rguard start
/opt/etc/init.d/S50rguard stop
/opt/etc/init.d/S50rguard restart
/opt/etc/init.d/S50rguard status
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ API Token (JWT) –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ HTTPS (TLS 1.3) –¥–ª—è Web UI
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (AES-256)
- ‚úÖ GPG –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- ‚úÖ Rate limiting (100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω)
- ‚úÖ CORS (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–µ IP)

---

## üìä –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|
| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | Entware (Keenetic) |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | MIPS, ARM, x86_64 |
| RAM (–º–∏–Ω) | 128 MB |
| RAM (—Ä–µ–∫) | 256 MB |
| Storage | 100 MB |

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üìñ [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/)
- üêõ [–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ](https://github.com/alexandr-kuz/RouteGuard/issues)
- üí° [–ò–¥–µ–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è](https://github.com/alexandr-kuz/RouteGuard/discussions)

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–º. [LICENSE](LICENSE)

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [sing-box](https://github.com/SagerNet/sing-box) ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ VPN-—è–¥—Ä–æ
- [Xray-core](https://github.com/XTLS/Xray-core) ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- [ByeDPI](https://github.com/ValdikSS/ByeDPI) ‚Äî –æ–±—Ö–æ–¥ DPI
- [AdGuard Home](https://github.com/AdguardTeam/AdGuardHome) ‚Äî DNS –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

---

## üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ

```bash
curl -sL https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/uninstall.sh | sh
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
```bash
/opt/etc/init.d/S50rguard stop && \
rm -f /opt/bin/routeguard /opt/etc/init.d/S50rguard && \
rm -rf /opt/etc/routeguard /opt/var/log/routeguard /opt/var/lib/routeguard && \
opkg remove sing-box smartdns byedpi
```
---

**RouteGuard** ¬© 2024. –°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.