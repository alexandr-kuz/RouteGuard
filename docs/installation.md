# ๐ฆ ะฃััะฐะฝะพะฒะบะฐ RouteGuard

## ะขัะตะฑะพะฒะฐะฝะธั

| ะขัะตะฑะพะฒะฐะฝะธะต | ะะฝะฐัะตะฝะธะต |
|------------|----------|
| ะะปะฐััะพัะผะฐ | Entware (Keenetic ัะพััะตัั) |
| ะััะธัะตะบัััะฐ | MIPS, ARM, x86_64 |
| RAM (ะผะธะฝะธะผัะผ) | 128 MB |
| RAM (ัะตะบะพะผะตะฝะดัะตััั) | 256 MB |
| ะกะฒะพะฑะพะดะฝะพะต ะผะตััะพ | 100 MB |

---

## ๐ ะััััะฐั ัััะฐะฝะพะฒะบะฐ

### ะกะฟะพัะพะฑ 1: curl | sh (ัะตะบะพะผะตะฝะดัะตััั)

```bash
curl -sL https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/install.sh | sh
```

**ะงัะพ ะดะตะปะฐะตั ัะบัะธะฟั:**

1. โ ะัะพะฒะตััะตั ะพะบััะถะตะฝะธะต (Entware, ะฐััะธัะตะบัััะฐ, ะฟะฐะผััั)
2. โ ะะฐะณััะถะฐะตั ะฑะธะฝะฐัะฝะธะบ ะดะปั ะฒะฐัะตะน ะฐััะธัะตะบัััั
3. โ ะัะพะฒะตััะตั ะบะพะฝััะพะปัะฝัั ััะผะผั (SHA256)
4. โ ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะทะฐะฒะธัะธะผะพััะธ (sing-box, smartdns, ByeDPI)
5. โ ะกะพะทะดะฐัั ะดะธัะตะบัะพัะธะธ ะธ ะบะพะฝัะธะณััะฐัะธั
6. โ ะะตะณะธัััะธััะตั ัะตัะฒะธั
7. โ ะะฐะฟััะบะฐะตั RouteGuard

### ะกะฟะพัะพะฑ 2: OPKG ะฟะฐะบะตั

```bash
# ะะฑะฝะพะฒะปะตะฝะธะต ัะฟะธัะบะพะฒ ะฟะฐะบะตัะพะฒ
opkg update

# ะะฐะณััะทะบะฐ ะธ ัััะฐะฝะพะฒะบะฐ
wget https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/routeguard.ipk
opkg install routeguard.ipk

# ะะปะธ ะฝะฐะฟััะผัั ะธะท URL
opkg install https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/routeguard.ipk
```

---

## ๐ ะะพัะปะต ัััะฐะฝะพะฒะบะธ

### 1. ะะพัััะฟ ะบ Web UI

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   RouteGuard ััะฟะตัะฝะพ ัััะฐะฝะพะฒะปะตะฝ!                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

  ๐ Web UI:  http://192.168.1.1:8080
  ๐ ะขะพะบะตะฝ:   your-api-token-here
```

**ะะฐะถะฝะพ:** ะกะพััะฐะฝะธัะต API ัะพะบะตะฝ ะฒ ะฑะตะทะพะฟะฐัะฝะพะผ ะผะตััะต!

### 2. ะะตัะฒัะน ะฒัะพะด

1. ะัะบัะพะนัะต ะฑัะฐัะทะตั ะธ ะฟะตัะตะนะดะธัะต ะฟะพ ะฐะดัะตัั `http://<IP-ัะพััะตัะฐ>:8080`
2. ะะฒะตะดะธัะต API ัะพะบะตะฝ ะธะท ะฒัะฒะพะดะฐ ัััะฐะฝะพะฒัะธะบะฐ
3. ะั ะฟะพะฟะฐะดััะต ะฝะฐ ะณะปะฐะฒะฝัั ะฟะฐะฝะตะปั

---

## ๐๏ธ ะฃะฟัะฐะฒะปะตะฝะธะต ัะตัะฒะธัะพะผ

### ะงะตัะตะท init.d ัะบัะธะฟั

```bash
# ะะฐะฟััะบ
/opt/etc/init.d/S50rguard start

# ะััะฐะฝะพะฒะบะฐ
/opt/etc/init.d/S50rguard stop

# ะะตัะตะทะฐะฟััะบ
/opt/etc/init.d/S50rguard restart

# ะกัะฐััั
/opt/etc/init.d/S50rguard status
```

### ะงะตัะตะท CLI

```bash
# ะกัะฐััั
routeguard status

# ะะฐะฟััะบ / ะพััะฐะฝะพะฒะบะฐ
routeguard start
routeguard stop
routeguard restart

# ะะพะณะธ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
routeguard logs --follow

# ะะฑะฝะพะฒะปะตะฝะธะต
routeguard update

# ะัะบะฐะฟ
routeguard backup > backup.json

# ะะพัััะฐะฝะพะฒะปะตะฝะธะต
routeguard restore < backup.json
```

---

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะฐัะฟะพะปะพะถะตะฝะธะต ัะฐะนะปะพะฒ

```
/opt/etc/routeguard/
โโโ config.json          # ะัะฝะพะฒะฝะพะน ะบะพะฝัะธะณ
โโโ .api_token           # API ัะพะบะตะฝ (ะฝะต ะดะตะปะธัะตัั!)
โโโ .local_ip            # ะะพะบะฐะปัะฝัะน IP ัะพััะตัะฐ
โโโ profiles/            # VPN ะฟัะพัะธะปะธ
โโโ rulesets/            # ะัะฐะฒะธะปะฐ ะผะฐัััััะธะทะฐัะธะธ
โโโ certs/               # SSL ัะตััะธัะธะบะฐัั
```

### ะะพะณะธ

```
/opt/var/log/routeguard/
โโโ routeguard.log       # ะัะฝะพะฒะฝะพะน ะปะพะณ
โโโ routeguard.log.1     # ะััะธะฒ ะปะพะณะพะฒ
```

### ะะฐะฝะฝัะต

```
/opt/var/lib/routeguard/
โโโ geoip/               # GeoIP ะฑะฐะทั
โโโ geosite/             # Geosite ะฑะฐะทั
โโโ backups/             # ะัะบะฐะฟั ะบะพะฝัะธะณััะฐัะธะธ
```

---

## ๐ ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ

### ะงะตัะตะท Web UI

1. ะัะบัะพะนัะต Web UI
2. ะะตัะตะนะดะธัะต ะฒ **ะะฐัััะพะนะบะธ**
3. ะะทะผะตะฝะธัะต ะฝัะถะฝัะต ะฟะฐัะฐะผะตััั
4. ะะฐะถะผะธัะต **ะกะพััะฐะฝะธัั**

### ะงะตัะตะท ัะฐะนะป

```bash
# ะัะบัััั ะบะพะฝัะธะณ
vi /opt/etc/routeguard/config.json

# ะะพัะปะต ะธะทะผะตะฝะตะฝะธะน ะฟะตัะตะทะฐะฟัััะธัั ัะตัะฒะธั
/opt/etc/init.d/S50rguard restart
```

### ะัะธะผะตั config.json

```json
{
    "api": {
        "port": 8080,
        "token": "your-token",
        "cors": true
    },
    "vpn": {
        "enabled": true,
        "core": "sing-box",
        "auto_connect": false
    },
    "routing": {
        "enabled": true,
        "mode": "domain",
        "default_route": "direct"
    },
    "dns": {
        "enabled": true,
        "port": 53,
        "upstream": "tls://1.1.1.1"
    },
    "dpi": {
        "enabled": false
    }
}
```

---

## ๐ ะะฑะฝะพะฒะปะตะฝะธะต

### ะะฒัะพะผะฐัะธัะตัะบะพะต

```bash
routeguard update
```

### ะัััะฝัั

```bash
# ะงะตัะตะท install.sh ั ะฒะตััะธะตะน
RG_VERSION=v0.2.0 curl -sL https://github.com/alexandr-kuz/RouteGuard/releases/download/v0.2.0/install.sh | sh
```

### ะะฒัะพะพะฑะฝะพะฒะปะตะฝะธั (ะพะฟัะธะพะฝะฐะปัะฝะพ)

ะะบะปััะธัะต ะฒ ะบะพะฝัะธะณะต:

```json
{
    "update": {
        "auto_check": true,
        "check_interval": "24h",
        "auto_install": false
    }
}
```

---

## ๐๏ธ ะฃะดะฐะปะตะฝะธะต

### ะงะตัะตะท uninstall ัะบัะธะฟั

```bash
curl -sL https://github.com/alexandr-kuz/RouteGuard/releases/latest/download/uninstall.sh | sh
```

### ะัััะฝัั

```bash
# ะััะฐะฝะพะฒะบะฐ ัะตัะฒะธัะฐ
/opt/etc/init.d/S50rguard stop

# ะฃะดะฐะปะตะฝะธะต ัะฐะนะปะพะฒ
rm -f /opt/bin/routeguard
rm -f /opt/etc/init.d/S50rguard
rm -rf /opt/etc/routeguard
rm -rf /opt/var/log/routeguard
rm -rf /opt/var/lib/routeguard

# (ะะฟัะธะพะฝะฐะปัะฝะพ) ะฃะดะฐะปะตะฝะธะต ะทะฐะฒะธัะธะผะพััะตะน
opkg remove sing-box smartdns byedpi
```

---

## โ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะกะตัะฒะธั ะฝะต ะทะฐะฟััะบะฐะตััั

```bash
# ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
cat /opt/var/log/routeguard/routeguard.log

# ะัะพะฒะตัะบะฐ ะฟะพััะฐ
netstat -tlnp | grep 8080

# ะัะพะฒะตัะบะฐ ะฟัะฐะฒ
ls -la /opt/bin/routeguard
```

### ะะต ะดะพัััะฟะตะฝ Web UI

1. ะัะพะฒะตัััะต ััะพ ัะตัะฒะธั ะทะฐะฟััะตะฝ: `routeguard status`
2. ะัะพะฒะตัััะต ะฟะพัั: `netstat -tlnp | grep 8080`
3. ะัะพะฒะตัััะต firewall ัะพััะตัะฐ
4. ะะพะฟัะพะฑัะนัะต ะดััะณะพะน ะฑัะฐัะทะตั

### ะัะธะฑะบะฐ ะฟัะธ ัััะฐะฝะพะฒะบะต

```bash
# ะัะพะฒะตัะบะฐ Entware
opkg --version

# ะัะพะฒะตัะบะฐ ะผะตััะฐ
df -h /opt

# ะัะพะฒะตัะบะฐ ะฟะฐะผััะธ
free -m

# ะะตัะตะทะฐะฟััะบ opkg
opkg update
```

### ะกะฑัะพั ะบะพะฝัะธะณััะฐัะธะธ

```bash
# ะัะบะฐะฟ ัะตะบััะตะน ะบะพะฝัะธะณััะฐัะธะธ
routeguard backup > backup.json

# ะฃะดะฐะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะธ
rm /opt/etc/routeguard/config.json

# ะะตัะตะทะฐะฟััะบ (ัะพะทะดะฐัััั ะฝะพะฒะฐั)
/opt/etc/init.d/S50rguard restart
```

---

## ๐ ะะพะดะดะตัะถะบะฐ

- ๐ [ะะพะบัะผะตะฝัะฐัะธั](../README.md)
- ๐ [ะกะพะพะฑัะธัั ะพะฑ ะพัะธะฑะบะต](https://github.com/alexandr-kuz/RouteGuard/issues)
- ๐ก [ะะฑััะถะดะตะฝะธะต](https://github.com/alexandr-kuz/RouteGuard/discussions)

---

**ะะฐะปะตะต:** [ะะฐัััะพะนะบะฐ VPN](modules/vpn.md) | [ะะฐัััััะธะทะฐัะธั](modules/routing.md) | [DNS](modules/dns.md)
